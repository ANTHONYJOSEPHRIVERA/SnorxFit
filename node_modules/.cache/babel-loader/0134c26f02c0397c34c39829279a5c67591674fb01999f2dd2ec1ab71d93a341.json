{"ast":null,"code":"// Sistema de recomendaciones nutricionales variadas\n// Ofrece múltiples alternativas para cada tipo de comida/objetivo nutricional\n\nimport { findFoods } from '../data/nutritionIndex';\n\n// Grupos de alimentos similares nutricional y funcionalmente\nconst foodGroups = {\n  proteinas_magras: {\n    name: 'Proteínas Magras',\n    searchTerms: ['chicken breast', 'fish', 'tuna', 'salmon', 'turkey', 'egg white', 'tofu'],\n    alternatives: ['pollo', 'pescado', 'atún', 'salmón', 'pavo', 'clara de huevo', 'tofu', 'quinoa'],\n    macroProfile: {\n      protein: 'high',\n      fat: 'low',\n      carbs: 'low'\n    }\n  },\n  proteinas_completas: {\n    name: 'Proteínas Completas',\n    searchTerms: ['beef', 'pork', 'lamb', 'cheese', 'milk', 'yogurt', 'eggs'],\n    alternatives: ['res', 'cerdo', 'cordero', 'queso', 'leche', 'yogurt', 'huevos', 'pescado graso'],\n    macroProfile: {\n      protein: 'high',\n      fat: 'medium',\n      carbs: 'low'\n    }\n  },\n  carbohidratos_complejos: {\n    name: 'Carbohidratos Complejos',\n    searchTerms: ['rice', 'oats', 'quinoa', 'sweet potato', 'potato', 'bread', 'pasta'],\n    alternatives: ['arroz integral', 'avena', 'quinoa', 'camote', 'papa', 'pan integral', 'pasta integral'],\n    macroProfile: {\n      protein: 'medium',\n      fat: 'low',\n      carbs: 'high'\n    }\n  },\n  frutas_energeticas: {\n    name: 'Frutas Energéticas',\n    searchTerms: ['banana', 'apple', 'orange', 'mango', 'pineapple', 'grapes'],\n    alternatives: ['plátano', 'manzana', 'naranja', 'mango', 'piña', 'uvas', 'fresas', 'kiwi'],\n    macroProfile: {\n      protein: 'low',\n      fat: 'low',\n      carbs: 'high'\n    }\n  },\n  verduras_verdes: {\n    name: 'Verduras Verdes',\n    searchTerms: ['spinach', 'broccoli', 'lettuce', 'kale', 'green beans'],\n    alternatives: ['espinaca', 'brócoli', 'lechuga', 'col rizada', 'vainitas', 'acelga', 'apio'],\n    macroProfile: {\n      protein: 'low',\n      fat: 'low',\n      carbs: 'low'\n    }\n  },\n  verduras_coloridas: {\n    name: 'Verduras Coloridas',\n    searchTerms: ['carrot', 'pepper', 'tomato', 'cucumber', 'beet'],\n    alternatives: ['zanahoria', 'pimiento', 'tomate', 'pepino', 'remolacha', 'calabaza', 'berenjena'],\n    macroProfile: {\n      protein: 'low',\n      fat: 'low',\n      carbs: 'medium'\n    }\n  },\n  grasas_saludables: {\n    name: 'Grasas Saludables',\n    searchTerms: ['avocado', 'olive oil', 'nuts', 'almonds', 'salmon', 'chia'],\n    alternatives: ['aguacate', 'aceite de oliva', 'nueces', 'almendras', 'salmón', 'chía', 'semillas'],\n    macroProfile: {\n      protein: 'medium',\n      fat: 'high',\n      carbs: 'low'\n    }\n  },\n  snacks_saludables: {\n    name: 'Snacks Saludables',\n    searchTerms: ['yogurt', 'fruit', 'nuts', 'berries', 'cheese'],\n    alternatives: ['yogurt griego', 'frutas', 'frutos secos', 'berries', 'queso bajo grasa', 'hummus'],\n    macroProfile: {\n      protein: 'medium',\n      fat: 'medium',\n      carbs: 'medium'\n    }\n  }\n};\n\n// Momentos del día y sus necesidades nutricionales\nconst mealTypes = {\n  desayuno: {\n    name: 'Desayuno',\n    priority: ['carbohidratos_complejos', 'proteinas_completas', 'frutas_energeticas'],\n    avoid: [],\n    calorieRatio: 0.25\n  },\n  almuerzo: {\n    name: 'Almuerzo',\n    priority: ['proteinas_magras', 'carbohidratos_complejos', 'verduras_coloridas', 'grasas_saludables'],\n    avoid: [],\n    calorieRatio: 0.35\n  },\n  cena: {\n    name: 'Cena',\n    priority: ['proteinas_magras', 'verduras_verdes', 'verduras_coloridas'],\n    avoid: ['carbohidratos_complejos'],\n    calorieRatio: 0.25\n  },\n  snack: {\n    name: 'Snack',\n    priority: ['snacks_saludables', 'frutas_energeticas'],\n    avoid: [],\n    calorieRatio: 0.15\n  }\n};\n\n// Objetivos nutricionales y sus prioridades\nconst nutritionGoals = {\n  perdida_peso: {\n    name: 'Pérdida de Peso',\n    priority: ['proteinas_magras', 'verduras_verdes', 'verduras_coloridas'],\n    moderate: ['grasas_saludables', 'frutas_energeticas'],\n    limit: ['carbohidratos_complejos']\n  },\n  ganancia_muscular: {\n    name: 'Ganancia Muscular',\n    priority: ['proteinas_completas', 'proteinas_magras', 'carbohidratos_complejos'],\n    moderate: ['grasas_saludables'],\n    limit: []\n  },\n  mantenimiento: {\n    name: 'Mantenimiento',\n    priority: ['proteinas_magras', 'carbohidratos_complejos', 'verduras_coloridas', 'grasas_saludables'],\n    moderate: ['frutas_energeticas', 'snacks_saludables'],\n    limit: []\n  },\n  energia_deportiva: {\n    name: 'Energía Deportiva',\n    priority: ['carbohidratos_complejos', 'proteinas_completas', 'frutas_energeticas'],\n    moderate: ['grasas_saludables'],\n    limit: []\n  }\n};\n\n/**\r\n * Genera recomendaciones variadas para un momento específico\r\n * @param {string} mealType - Tipo de comida (desayuno, almuerzo, cena, snack)\r\n * @param {string} goal - Objetivo nutricional\r\n * @param {Array} excludedFoods - Alimentos que el usuario no quiere\r\n * @param {number} optionsPerGroup - Número de opciones por grupo de alimentos\r\n * @returns {Promise<Object>} Recomendaciones organizadas por grupos\r\n */\nexport const generateVariedRecommendations = async (mealType = 'almuerzo', goal = 'mantenimiento', excludedFoods = [], optionsPerGroup = 3) => {\n  const meal = mealTypes[mealType] || mealTypes.almuerzo;\n  const goalConfig = nutritionGoals[goal] || nutritionGoals.mantenimiento;\n  const recommendations = {};\n  const excludedNames = excludedFoods.map(f => f.toLowerCase());\n\n  // Combinar prioridades del momento del día y objetivo nutricional\n  const priorityGroups = [...new Set([...meal.priority, ...goalConfig.priority])];\n  for (const groupId of priorityGroups) {\n    const group = foodGroups[groupId];\n    if (!group) continue;\n\n    // Buscar alternativas para este grupo\n    const allOptions = [];\n\n    // Buscar usando términos en inglés y alternativas en español\n    for (const term of [...group.searchTerms, ...group.alternatives]) {\n      try {\n        const results = await findFoods(term, 10);\n        allOptions.push(...results);\n      } catch (error) {\n        console.warn(`Error buscando ${term}:`, error);\n      }\n    }\n\n    // Filtrar duplicados y excluidos\n    const uniqueOptions = allOptions.filter((food, index, self) => index === self.findIndex(f => f.nombre === food.nombre || f.nombre_es === food.nombre_es)).filter(food => {\n      const name = (food.nombre_es || food.nombre || '').toLowerCase();\n      return !excludedNames.some(excluded => name.includes(excluded));\n    }).slice(0, optionsPerGroup * 2); // Obtener más opciones para tener variedad\n\n    if (uniqueOptions.length > 0) {\n      recommendations[groupId] = {\n        groupName: group.name,\n        macroProfile: group.macroProfile,\n        options: uniqueOptions.slice(0, optionsPerGroup),\n        alternativeOptions: uniqueOptions.slice(optionsPerGroup, optionsPerGroup * 2)\n      };\n    }\n  }\n  return {\n    mealType: meal.name,\n    goal: goalConfig.name,\n    recommendations,\n    totalGroups: Object.keys(recommendations).length\n  };\n};\n\n/**\r\n * Obtiene alternativas para un alimento específico que el usuario rechazó\r\n * @param {Object} rejectedFood - Alimento rechazado\r\n * @param {string} mealType - Tipo de comida\r\n * @param {number} limit - Número máximo de alternativas\r\n * @returns {Promise<Array>} Lista de alimentos alternativos\r\n */\nexport const getAlternatives = async (rejectedFood, mealType = 'almuerzo', limit = 5) => {\n  // Identificar el grupo nutricional del alimento rechazado\n  const foodName = (rejectedFood.nombre_es || rejectedFood.nombre || '').toLowerCase();\n  let matchedGroup = null;\n  for (const [groupId, group] of Object.entries(foodGroups)) {\n    const isMatch = group.searchTerms.some(term => foodName.includes(term.toLowerCase())) || group.alternatives.some(alt => foodName.includes(alt.toLowerCase()));\n    if (isMatch) {\n      matchedGroup = {\n        id: groupId,\n        ...group\n      };\n      break;\n    }\n  }\n  if (!matchedGroup) {\n    // Si no encontramos grupo específico, buscar por categoría nutricional similar\n    const calorias = rejectedFood.calorias || 0;\n    const proteina = rejectedFood.proteina || 0;\n    const carbohidratos = rejectedFood.carbohidratos || 0;\n    const grasa = rejectedFood.grasa_total || 0;\n\n    // Buscar alimentos con perfil nutricional similar\n    return await findFoods('', limit * 2);\n  }\n\n  // Buscar alternativas del mismo grupo\n  const alternatives = [];\n  const rejectedName = foodName;\n  for (const term of [...matchedGroup.searchTerms, ...matchedGroup.alternatives]) {\n    if (term.toLowerCase() === rejectedName) continue; // Evitar el mismo alimento\n\n    try {\n      const results = await findFoods(term, 3);\n      alternatives.push(...results);\n    } catch (error) {\n      console.warn(`Error buscando alternativa ${term}:`, error);\n    }\n  }\n\n  // Filtrar duplicados y el alimento rechazado\n  const uniqueAlternatives = alternatives.filter((food, index, self) => index === self.findIndex(f => f.nombre === food.nombre || f.nombre_es === food.nombre_es)).filter(food => {\n    const name = (food.nombre_es || food.nombre || '').toLowerCase();\n    return name !== rejectedName;\n  }).slice(0, limit);\n  return uniqueAlternatives;\n};\n\n/**\r\n * Genera un plan de comidas completo con múltiples opciones\r\n * @param {Object} userProfile - Perfil del usuario\r\n * @param {string} goal - Objetivo nutricional\r\n * @param {Array} preferences - Preferencias alimentarias\r\n * @param {Array} restrictions - Restricciones/alergias\r\n * @returns {Promise<Object>} Plan de comidas con alternativas\r\n */\nexport const generateMealPlanWithAlternatives = async (userProfile, goal = 'mantenimiento', preferences = [], restrictions = []) => {\n  const mealPlan = {};\n  const meals = ['desayuno', 'snack', 'almuerzo', 'cena'];\n  for (const meal of meals) {\n    mealPlan[meal] = await generateVariedRecommendations(meal, goal, restrictions, 3 // 3 opciones por grupo\n    );\n  }\n  return {\n    userProfile,\n    goal,\n    preferences,\n    restrictions,\n    mealPlan,\n    generatedAt: new Date().toISOString()\n  };\n};\nexport default {\n  generateVariedRecommendations,\n  getAlternatives,\n  generateMealPlanWithAlternatives,\n  foodGroups,\n  mealTypes,\n  nutritionGoals\n};","map":{"version":3,"names":["findFoods","foodGroups","proteinas_magras","name","searchTerms","alternatives","macroProfile","protein","fat","carbs","proteinas_completas","carbohidratos_complejos","frutas_energeticas","verduras_verdes","verduras_coloridas","grasas_saludables","snacks_saludables","mealTypes","desayuno","priority","avoid","calorieRatio","almuerzo","cena","snack","nutritionGoals","perdida_peso","moderate","limit","ganancia_muscular","mantenimiento","energia_deportiva","generateVariedRecommendations","mealType","goal","excludedFoods","optionsPerGroup","meal","goalConfig","recommendations","excludedNames","map","f","toLowerCase","priorityGroups","Set","groupId","group","allOptions","term","results","push","error","console","warn","uniqueOptions","filter","food","index","self","findIndex","nombre","nombre_es","some","excluded","includes","slice","length","groupName","options","alternativeOptions","totalGroups","Object","keys","getAlternatives","rejectedFood","foodName","matchedGroup","entries","isMatch","alt","id","calorias","proteina","carbohidratos","grasa","grasa_total","rejectedName","uniqueAlternatives","generateMealPlanWithAlternatives","userProfile","preferences","restrictions","mealPlan","meals","generatedAt","Date","toISOString"],"sources":["C:/xampp/htdocs/FICTIA/src/utils/nutritionRecommendations.js"],"sourcesContent":["// Sistema de recomendaciones nutricionales variadas\r\n// Ofrece múltiples alternativas para cada tipo de comida/objetivo nutricional\r\n\r\nimport { findFoods } from '../data/nutritionIndex';\r\n\r\n// Grupos de alimentos similares nutricional y funcionalmente\r\nconst foodGroups = {\r\n  proteinas_magras: {\r\n    name: 'Proteínas Magras',\r\n    searchTerms: ['chicken breast', 'fish', 'tuna', 'salmon', 'turkey', 'egg white', 'tofu'],\r\n    alternatives: ['pollo', 'pescado', 'atún', 'salmón', 'pavo', 'clara de huevo', 'tofu', 'quinoa'],\r\n    macroProfile: { protein: 'high', fat: 'low', carbs: 'low' }\r\n  },\r\n  proteinas_completas: {\r\n    name: 'Proteínas Completas',\r\n    searchTerms: ['beef', 'pork', 'lamb', 'cheese', 'milk', 'yogurt', 'eggs'],\r\n    alternatives: ['res', 'cerdo', 'cordero', 'queso', 'leche', 'yogurt', 'huevos', 'pescado graso'],\r\n    macroProfile: { protein: 'high', fat: 'medium', carbs: 'low' }\r\n  },\r\n  carbohidratos_complejos: {\r\n    name: 'Carbohidratos Complejos',\r\n    searchTerms: ['rice', 'oats', 'quinoa', 'sweet potato', 'potato', 'bread', 'pasta'],\r\n    alternatives: ['arroz integral', 'avena', 'quinoa', 'camote', 'papa', 'pan integral', 'pasta integral'],\r\n    macroProfile: { protein: 'medium', fat: 'low', carbs: 'high' }\r\n  },\r\n  frutas_energeticas: {\r\n    name: 'Frutas Energéticas',\r\n    searchTerms: ['banana', 'apple', 'orange', 'mango', 'pineapple', 'grapes'],\r\n    alternatives: ['plátano', 'manzana', 'naranja', 'mango', 'piña', 'uvas', 'fresas', 'kiwi'],\r\n    macroProfile: { protein: 'low', fat: 'low', carbs: 'high' }\r\n  },\r\n  verduras_verdes: {\r\n    name: 'Verduras Verdes',\r\n    searchTerms: ['spinach', 'broccoli', 'lettuce', 'kale', 'green beans'],\r\n    alternatives: ['espinaca', 'brócoli', 'lechuga', 'col rizada', 'vainitas', 'acelga', 'apio'],\r\n    macroProfile: { protein: 'low', fat: 'low', carbs: 'low' }\r\n  },\r\n  verduras_coloridas: {\r\n    name: 'Verduras Coloridas',\r\n    searchTerms: ['carrot', 'pepper', 'tomato', 'cucumber', 'beet'],\r\n    alternatives: ['zanahoria', 'pimiento', 'tomate', 'pepino', 'remolacha', 'calabaza', 'berenjena'],\r\n    macroProfile: { protein: 'low', fat: 'low', carbs: 'medium' }\r\n  },\r\n  grasas_saludables: {\r\n    name: 'Grasas Saludables',\r\n    searchTerms: ['avocado', 'olive oil', 'nuts', 'almonds', 'salmon', 'chia'],\r\n    alternatives: ['aguacate', 'aceite de oliva', 'nueces', 'almendras', 'salmón', 'chía', 'semillas'],\r\n    macroProfile: { protein: 'medium', fat: 'high', carbs: 'low' }\r\n  },\r\n  snacks_saludables: {\r\n    name: 'Snacks Saludables',\r\n    searchTerms: ['yogurt', 'fruit', 'nuts', 'berries', 'cheese'],\r\n    alternatives: ['yogurt griego', 'frutas', 'frutos secos', 'berries', 'queso bajo grasa', 'hummus'],\r\n    macroProfile: { protein: 'medium', fat: 'medium', carbs: 'medium' }\r\n  }\r\n};\r\n\r\n// Momentos del día y sus necesidades nutricionales\r\nconst mealTypes = {\r\n  desayuno: {\r\n    name: 'Desayuno',\r\n    priority: ['carbohidratos_complejos', 'proteinas_completas', 'frutas_energeticas'],\r\n    avoid: [],\r\n    calorieRatio: 0.25\r\n  },\r\n  almuerzo: {\r\n    name: 'Almuerzo',\r\n    priority: ['proteinas_magras', 'carbohidratos_complejos', 'verduras_coloridas', 'grasas_saludables'],\r\n    avoid: [],\r\n    calorieRatio: 0.35\r\n  },\r\n  cena: {\r\n    name: 'Cena',\r\n    priority: ['proteinas_magras', 'verduras_verdes', 'verduras_coloridas'],\r\n    avoid: ['carbohidratos_complejos'],\r\n    calorieRatio: 0.25\r\n  },\r\n  snack: {\r\n    name: 'Snack',\r\n    priority: ['snacks_saludables', 'frutas_energeticas'],\r\n    avoid: [],\r\n    calorieRatio: 0.15\r\n  }\r\n};\r\n\r\n// Objetivos nutricionales y sus prioridades\r\nconst nutritionGoals = {\r\n  perdida_peso: {\r\n    name: 'Pérdida de Peso',\r\n    priority: ['proteinas_magras', 'verduras_verdes', 'verduras_coloridas'],\r\n    moderate: ['grasas_saludables', 'frutas_energeticas'],\r\n    limit: ['carbohidratos_complejos']\r\n  },\r\n  ganancia_muscular: {\r\n    name: 'Ganancia Muscular',\r\n    priority: ['proteinas_completas', 'proteinas_magras', 'carbohidratos_complejos'],\r\n    moderate: ['grasas_saludables'],\r\n    limit: []\r\n  },\r\n  mantenimiento: {\r\n    name: 'Mantenimiento',\r\n    priority: ['proteinas_magras', 'carbohidratos_complejos', 'verduras_coloridas', 'grasas_saludables'],\r\n    moderate: ['frutas_energeticas', 'snacks_saludables'],\r\n    limit: []\r\n  },\r\n  energia_deportiva: {\r\n    name: 'Energía Deportiva',\r\n    priority: ['carbohidratos_complejos', 'proteinas_completas', 'frutas_energeticas'],\r\n    moderate: ['grasas_saludables'],\r\n    limit: []\r\n  }\r\n};\r\n\r\n/**\r\n * Genera recomendaciones variadas para un momento específico\r\n * @param {string} mealType - Tipo de comida (desayuno, almuerzo, cena, snack)\r\n * @param {string} goal - Objetivo nutricional\r\n * @param {Array} excludedFoods - Alimentos que el usuario no quiere\r\n * @param {number} optionsPerGroup - Número de opciones por grupo de alimentos\r\n * @returns {Promise<Object>} Recomendaciones organizadas por grupos\r\n */\r\nexport const generateVariedRecommendations = async (\r\n  mealType = 'almuerzo',\r\n  goal = 'mantenimiento',\r\n  excludedFoods = [],\r\n  optionsPerGroup = 3\r\n) => {\r\n  const meal = mealTypes[mealType] || mealTypes.almuerzo;\r\n  const goalConfig = nutritionGoals[goal] || nutritionGoals.mantenimiento;\r\n  \r\n  const recommendations = {};\r\n  const excludedNames = excludedFoods.map(f => f.toLowerCase());\r\n  \r\n  // Combinar prioridades del momento del día y objetivo nutricional\r\n  const priorityGroups = [...new Set([...meal.priority, ...goalConfig.priority])];\r\n  \r\n  for (const groupId of priorityGroups) {\r\n    const group = foodGroups[groupId];\r\n    if (!group) continue;\r\n    \r\n    // Buscar alternativas para este grupo\r\n    const allOptions = [];\r\n    \r\n    // Buscar usando términos en inglés y alternativas en español\r\n    for (const term of [...group.searchTerms, ...group.alternatives]) {\r\n      try {\r\n        const results = await findFoods(term, 10);\r\n        allOptions.push(...results);\r\n      } catch (error) {\r\n        console.warn(`Error buscando ${term}:`, error);\r\n      }\r\n    }\r\n    \r\n    // Filtrar duplicados y excluidos\r\n    const uniqueOptions = allOptions\r\n      .filter((food, index, self) => \r\n        index === self.findIndex(f => f.nombre === food.nombre || f.nombre_es === food.nombre_es)\r\n      )\r\n      .filter(food => {\r\n        const name = (food.nombre_es || food.nombre || '').toLowerCase();\r\n        return !excludedNames.some(excluded => name.includes(excluded));\r\n      })\r\n      .slice(0, optionsPerGroup * 2); // Obtener más opciones para tener variedad\r\n    \r\n    if (uniqueOptions.length > 0) {\r\n      recommendations[groupId] = {\r\n        groupName: group.name,\r\n        macroProfile: group.macroProfile,\r\n        options: uniqueOptions.slice(0, optionsPerGroup),\r\n        alternativeOptions: uniqueOptions.slice(optionsPerGroup, optionsPerGroup * 2)\r\n      };\r\n    }\r\n  }\r\n  \r\n  return {\r\n    mealType: meal.name,\r\n    goal: goalConfig.name,\r\n    recommendations,\r\n    totalGroups: Object.keys(recommendations).length\r\n  };\r\n};\r\n\r\n/**\r\n * Obtiene alternativas para un alimento específico que el usuario rechazó\r\n * @param {Object} rejectedFood - Alimento rechazado\r\n * @param {string} mealType - Tipo de comida\r\n * @param {number} limit - Número máximo de alternativas\r\n * @returns {Promise<Array>} Lista de alimentos alternativos\r\n */\r\nexport const getAlternatives = async (rejectedFood, mealType = 'almuerzo', limit = 5) => {\r\n  // Identificar el grupo nutricional del alimento rechazado\r\n  const foodName = (rejectedFood.nombre_es || rejectedFood.nombre || '').toLowerCase();\r\n  \r\n  let matchedGroup = null;\r\n  for (const [groupId, group] of Object.entries(foodGroups)) {\r\n    const isMatch = group.searchTerms.some(term => foodName.includes(term.toLowerCase())) ||\r\n                   group.alternatives.some(alt => foodName.includes(alt.toLowerCase()));\r\n    \r\n    if (isMatch) {\r\n      matchedGroup = { id: groupId, ...group };\r\n      break;\r\n    }\r\n  }\r\n  \r\n  if (!matchedGroup) {\r\n    // Si no encontramos grupo específico, buscar por categoría nutricional similar\r\n    const calorias = rejectedFood.calorias || 0;\r\n    const proteina = rejectedFood.proteina || 0;\r\n    const carbohidratos = rejectedFood.carbohidratos || 0;\r\n    const grasa = rejectedFood.grasa_total || 0;\r\n    \r\n    // Buscar alimentos con perfil nutricional similar\r\n    return await findFoods('', limit * 2);\r\n  }\r\n  \r\n  // Buscar alternativas del mismo grupo\r\n  const alternatives = [];\r\n  const rejectedName = foodName;\r\n  \r\n  for (const term of [...matchedGroup.searchTerms, ...matchedGroup.alternatives]) {\r\n    if (term.toLowerCase() === rejectedName) continue; // Evitar el mismo alimento\r\n    \r\n    try {\r\n      const results = await findFoods(term, 3);\r\n      alternatives.push(...results);\r\n    } catch (error) {\r\n      console.warn(`Error buscando alternativa ${term}:`, error);\r\n    }\r\n  }\r\n  \r\n  // Filtrar duplicados y el alimento rechazado\r\n  const uniqueAlternatives = alternatives\r\n    .filter((food, index, self) => \r\n      index === self.findIndex(f => f.nombre === food.nombre || f.nombre_es === food.nombre_es)\r\n    )\r\n    .filter(food => {\r\n      const name = (food.nombre_es || food.nombre || '').toLowerCase();\r\n      return name !== rejectedName;\r\n    })\r\n    .slice(0, limit);\r\n  \r\n  return uniqueAlternatives;\r\n};\r\n\r\n/**\r\n * Genera un plan de comidas completo con múltiples opciones\r\n * @param {Object} userProfile - Perfil del usuario\r\n * @param {string} goal - Objetivo nutricional\r\n * @param {Array} preferences - Preferencias alimentarias\r\n * @param {Array} restrictions - Restricciones/alergias\r\n * @returns {Promise<Object>} Plan de comidas con alternativas\r\n */\r\nexport const generateMealPlanWithAlternatives = async (\r\n  userProfile,\r\n  goal = 'mantenimiento',\r\n  preferences = [],\r\n  restrictions = []\r\n) => {\r\n  const mealPlan = {};\r\n  const meals = ['desayuno', 'snack', 'almuerzo', 'cena'];\r\n  \r\n  for (const meal of meals) {\r\n    mealPlan[meal] = await generateVariedRecommendations(\r\n      meal,\r\n      goal,\r\n      restrictions,\r\n      3 // 3 opciones por grupo\r\n    );\r\n  }\r\n  \r\n  return {\r\n    userProfile,\r\n    goal,\r\n    preferences,\r\n    restrictions,\r\n    mealPlan,\r\n    generatedAt: new Date().toISOString()\r\n  };\r\n};\r\n\r\nexport default {\r\n  generateVariedRecommendations,\r\n  getAlternatives,\r\n  generateMealPlanWithAlternatives,\r\n  foodGroups,\r\n  mealTypes,\r\n  nutritionGoals\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}